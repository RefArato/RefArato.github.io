<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>虚構幻想</title>

  <style>
    /* =========================================================
      1) テーマ変数（色・全体の調整ポイント）
      ここを触ると、サイト全体の雰囲気が一括で変わります。
    ========================================================= */
    :root{
      --bg:#000;
      --fg:#eaf2ff;
      --line:rgba(234,242,255,.18);

      /* メニュー通常色 */
      --menu:#a8e3df;

      /* ホバー時（英字側）の色 */
      --accent:#4fc3ff;

      /* グリッチ色 */
      --accent2:#a7e7ff;

      /* ★メニュー全体を下げたいときの微調整（px） */
      --menuShiftY: 80px; /* ← ここを増やすともっと下へ */

      /* ★メニュー文字だけ“少し下げる”量（グリッチ中も含めて固定） */
      --labelShiftY: 6px; /* ← ここを変えると文字だけ上下 */
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }

    /* =========================================================
      2) 背景・全体レイアウト
    ========================================================= */
    body{
      margin:0;
      background:
        radial-gradient(900px 500px at 50% 20%, rgba(79,195,255,.10), transparent 60%),
        radial-gradient(900px 600px at 50% 120%, rgba(79,195,255,.06), transparent 60%),
        var(--bg);
      color:var(--fg);
      font-family: ui-sans-serif, system-ui, -apple-system, "Hiragino Sans", "Noto Sans JP", sans-serif;
      overflow:hidden;
    }

    /* 背景パーティクル（canvas） */
    #dust{
      position:fixed;
      inset:0;
      z-index:-1;
      pointer-events:none;
    }

    /* 縦積みレイアウト */
    .wrap{
      min-height:100%;
      display:flex;
      flex-direction:column;
      align-items:center;
    }

    /* =========================================================
      3) タイトル（元サイズ）
    ========================================================= */
    .title-area{
      width:min(980px, 92vw);
      text-align:center;
      margin-top: clamp(42px, 8vh, 80px);
    }

    .title{
      font-size: clamp(44px, 8vw, 86px);
      letter-spacing: .22em;
      font-weight: 300;
      color: rgba(234,242,255,.95);
      text-shadow:
        0 0 10px rgba(167,231,255,.12),
        0 0 26px rgba(79,195,255,.12);
      margin:0;
    }

    .title-line{
      width:min(640px, 74vw);
      height:1px;
      margin: 16px auto 0;
      background: linear-gradient(90deg, transparent, var(--line), transparent);
    }

    /* =========================================================
      4) メニュー（全体位置を下げる）
    ========================================================= */
    .menu{
      margin-top: calc(clamp(40px, 10vh, 90px) + var(--menuShiftY));
      display:flex;
      flex-direction:column;
      gap: 18px;
      align-items:center;
      user-select:none;
    }

    .menu-item{
      position:relative;
      padding: 6px 18px;
      font-size: 22px;
      letter-spacing: .12em;
      background: transparent;
      border: 0;
      cursor: pointer;
      -webkit-tap-highlight-color: transparent;
      white-space: nowrap;
      min-width: 14ch;
      text-align: center;
    }

    /* =========================================================
      文字描画のコア
      - 通常時：translateY(var(--labelShiftY)) で下げる
      - グリッチ時：baseShake側にも同じ下げ量を含めてズレ防止
    ========================================================= */
    .menu-item .label{
      position:relative;
      display:block;
      height:1.2em;
      line-height:1.2em;
      color: transparent;
      transform: translateZ(0) translateY(var(--labelShiftY));
    }

    /* 通常表示テキスト */
    .menu-item .label::after{
      content: attr(data-display-text);
      position:absolute;
      top:0;
      left:50%;
      transform: translateX(-50%);
      color: var(--menu);
      text-shadow: 0 0 18px rgba(0,0,0,.35);
      pointer-events:none;
    }

    /* グリッチ表示テキスト */
    .menu-item .label::before{
      content: attr(data-glitch-text);
      position:absolute;
      top:0;
      left:50%;
      transform: translateX(-50%);
      opacity:0;
      color: var(--accent2);
      mix-blend-mode: screen;
      filter: blur(.2px);
      pointer-events:none;
    }

    /* ホバー中（英字ラベルの色） */
    .menu-item.is-alt .label::after{
      color: var(--accent);
    }

    /* グリッチ中 */
    .menu-item.is-glitch .label::before{
      opacity:1;
      animation: glitchJitter 120ms steps(2,end) infinite;
    }
    .menu-item.is-glitch .label{
      animation: baseShake 90ms steps(2,end) infinite;
    }

    @keyframes glitchJitter{
      0%{ transform: translateX(-50%) translate(0,0); }
      50%{ transform: translateX(-50%) translate(2px,-1px); }
      100%{ transform: translateX(-50%) translate(0,0); }
    }

    /* ★ここがズレ解消の本体：
       baseShake の transform にも translateY(var(--labelShiftY)) を常に含める */
    @keyframes baseShake{
      0%{ transform: translateY(var(--labelShiftY)) translate(0,0); }
      50%{ transform: translateY(var(--labelShiftY)) translate(-1px,1px); }
      100%{ transform: translateY(var(--labelShiftY)) translate(0,0); }
    }

    /* 操作ヒント */
    .hint{
      position:fixed;
      bottom:22px;
      left:50%;
      transform: translateX(-50%);
      color: rgba(234,242,255,.30);
      font-size:12px;
      letter-spacing:.18em;
      pointer-events:none;
    }

    /* スマホ調整 */
    @media (max-width:520px){
      .menu-item{ font-size: 18px; min-width: 16ch; }
      .title{ letter-spacing:.16em; }

      :root{
        --menuShiftY: 60px;
        --labelShiftY: 6px;
      }
    }
  </style>
</head>

<body>
  <!-- 背景パーティクル -->
  <canvas id="dust"></canvas>

  <div class="wrap">
    <!-- タイトル -->
    <div class="title-area">
      <h1 class="title">虚構幻想</h1>
      <div class="title-line"></div>
    </div>

    <!-- メニュー -->
    <div class="menu">
      <button class="menu-item" data-original="はじめから" data-alt="- WEB TOP -">
        <span class="label" data-display-text="はじめから"></span>
      </button>
      <button class="menu-item" data-original="作品紹介" data-alt="- WORKS -">
        <span class="label" data-display-text="作品紹介"></span>
      </button>
      <button class="menu-item" data-original="ギャラリー" data-alt="- GALLERY -">
        <span class="label" data-display-text="ギャラリー"></span>
      </button>
      <button class="menu-item" data-original="メンバー" data-alt="- MEMBERS -">
        <span class="label" data-display-text="メンバー"></span>
      </button>
      <button class="menu-item" data-original="依頼" data-alt="- CONTACT -">
        <span class="label" data-display-text="依頼"></span>
      </button>
    </div>
  </div>

  <div class="hint">MOVE CURSOR</div>

  <script>
  /* =========================================================
    5) メニュー・グリッチ
  ========================================================= */
  (() => {
    const letters = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";
    document.querySelectorAll(".menu-item").forEach(btn => {
      const label = btn.querySelector(".label");
      const { original, alt } = btn.dataset;

      function glitchOnce(text, duration = 200){
        const start = performance.now();
        const len = text.length;

        function frame(now){
          const t = Math.min(1, (now - start) / duration);
          const reveal = Math.floor(len * t);

          let out = "";
          for(let i=0;i<len;i++){
            out += (i < reveal) ? text[i] : letters[(Math.random()*letters.length)|0];
          }
          label.dataset.glitchText = out;

          if(t < 1) requestAnimationFrame(frame);
          else label.dataset.glitchText = "";
        }
        requestAnimationFrame(frame);
      }

      btn.addEventListener("mouseenter", () => {
        btn.classList.add("is-alt","is-glitch");
        label.dataset.displayText = alt;
        glitchOnce(alt, 200);
        setTimeout(() => btn.classList.remove("is-glitch"), 260);
      });

      btn.addEventListener("mouseleave", () => {
        btn.classList.remove("is-alt","is-glitch");
        label.dataset.displayText = original;
        label.dataset.glitchText = "";
      });
    });
  })();
  </script>

  <script>
  /* =========================================================
    6) ドット調・浮遊パーティクル（軽量 / 軌跡なし / 四角）
  ========================================================= */
  (() => {
    const canvas = document.getElementById("dust");
    const ctx = canvas.getContext("2d", { alpha:true });

    const DPR = Math.min(2, window.devicePixelRatio || 1);
    let W = 0, H = 0;

    function resize(){
      W = innerWidth; H = innerHeight;
      canvas.width  = Math.floor(W * DPR);
      canvas.height = Math.floor(H * DPR);
      canvas.style.width  = W + "px";
      canvas.style.height = H + "px";
      ctx.setTransform(DPR,0,0,DPR,0,0);
    }
    addEventListener("resize", resize, { passive:true });
    resize();

    const rand = (a,b)=>a+Math.random()*(b-a);

    // 粒数（軽さ重視：上限60）
    const count = Math.max(28, Math.min(60, (W*H)/28000 | 0));

    // 粒データ
    const ps = [...Array(count)].map(() => {
      const d = rand(0, Math.PI * 2);
      return {
        x: rand(0,W), y: rand(0,H),
        s: rand(2.0, 5.0),
        vx: Math.cos(d) * rand(.05, .2),
        vy: Math.sin(d) * rand(.05, .2),
        a: rand(.1, .26),
        ph: rand(0, Math.PI*2),
        tw: rand(.004, .012),
        dir: d, drift: rand(.6, 1.6)
      };
    });

    const MAX=.1, TURN=.02, WANDER=.018, DRAG=.992;

    function step(){
      ctx.clearRect(0,0,W,H);

      for(const p of ps){
        p.ph += p.tw;
        const alpha = p.a + Math.sin(p.ph) * 0.5;

        p.dir += (Math.sin(p.ph*p.drift) + (Math.random() - .05)) * WANDER;

        p.vx += (Math.cos(p.dir)*MAX - p.vx) * TURN;
        p.vy += (Math.sin(p.dir)*MAX - p.vy) * TURN;

        p.vx *= DRAG; p.vy *= DRAG;
        p.x += p.vx; p.y += p.vy;

        if(p.x < -20) p.x = W + 20;
        if(p.x >  W+20) p.x = -20;
        if(p.y < -20) p.y = H + 20;
        if(p.y >  H+20) p.y = -20;

        ctx.fillStyle = `rgba(150,230,255,${alpha})`;
        ctx.fillRect(p.x - p.s/2, p.y - p.s/2, p.s, p.s);
      }

      requestAnimationFrame(step);
    }
    step();
  })();
  </script>
</body>
</html>
